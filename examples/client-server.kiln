;;; FIXME: this works, but it's technically not guaranteed that these `defhost` forms
;;;         are executed before the kells are loaded.
(defhost 'client "localhost" 8000)
(defhost 'server "otherhost" 8000)

(load "library/utilities")
(load "library/simple-components")

[client (par [a (par (include-component "library/simple-io")
                     (trigger* {signal ?i}
                               (par {= (list ?i 5
                                             (par {move}
                                                  {+ (list ?i 1 {signal})})
                                             {nope})}
                                    {= (list ?i 10 null-process {nope})}
                                    (trigger (par {nope} {nope})
                                             (par {echo ?i}
                                                  {+ (list ?i 1 {signal})}))))
                     {signal 0})]
             (trigger {move _ down}
                      (trigger [a ?x] {move ?x})))]

[server (par (include-component "library/simple-io")
             (trigger* {move ?proc up} ?proc))]

(trigger* {move ?proc down} {move ?proc})
